options(bitmapType='cairo')
allDat = read.table("Brain_Clinical_TPM_annotate_geneName_reorder_AVGMAX_surface_antigen.txt", header=TRUE, row.names=1 ,sep="\t");
selection = allDat;
rownames = rownames(selection);
A = c('SJEPD003.D','SJEPD030060.D1','SJEPD030097.D1','SJEPD030097.D2','SJEPD030146.D1','SJEPD030168.D1','SJEPD030169.D1','SJEPD030229.D1','SJEPD030232.D1','SJEPD030250.D1','SJEPD030277.D1','SJEPD030292.D1','SJEPD030367.D2','SJEPD030388.D1','SJEPD030391.D1','SJEPD030399.D1','SJEPD030469.D1','SJEPD030486.D1','SJEPD030512.D1','SJEPD030580.D1','SJEPD030584.D1','SJEPD030600.D1','SJEPD030627.D1','SJEPD030655.D1','SJEPD030743.D1','SJEPD030745.D1','SJEPD030766.D1','SJEPD030767.D1','SJEPD030770.D1','SJEPD030782.D1','SJEPD030784.D1','SJEPD030791.D1','SJEPD030795.D1','SJEPD030795.D2','SJEPD030795.D3','SJEPD030833.D1','SJEPD030854.D1','SJEPD030908.D1','SJEPD030911.D1','SJEPD030930.D1','SJEPD030942.D1','SJEPD030943.D1','SJEPD030948.D1','SJEPD030950.D1','SJEPD030972.D1','SJEPD031010.D1','SJEPD031078.D1','SJEPD031078.D2','SJEPD031093.D1','SJEPD031102.D1','SJEPD031111.D1','SJEPD031129.D1','SJEPD031137.D1','SJEPD031138.D1','SJEPD031138.D2','SJEPD031150.D1','SJEPD031160.D1','SJEPD031164.D1','SJEPD031175.D1','SJEPD031215.D1','SJEPD031233.D1','SJEPD031236.D1','SJEPD031238.D1','SJEPD031285.D1','SJEPD031319.D1','SJEPD031367.D1','SJEPD031372.D1','SJEPD031385.D1','SJEPD031429.D1','SJEPD031448.D1','SJEPD031509.D1','SJHGG001.A','SJHGG003.A','SJHGG030166.D1','SJHGG030179.D1','SJHGG030198.D1','SJHGG030230.D1','SJHGG030230.R1','SJHGG030242.D1','SJHGG030278.D1','SJHGG030284.D1','SJHGG030319.D1','SJHGG030335.D1','SJHGG030336.D1','SJHGG030374.D1','SJHGG030397.D1','SJHGG030398.D1','SJHGG030406.D2','SJHGG030462.D1','SJHGG030465.D1','SJHGG030497.D1','SJHGG030514.D1','SJHGG030514.R1','SJHGG030544.D1','SJHGG030544.D2','SJHGG030578.D1','SJHGG030628.D1','SJHGG030665.D1','SJHGG030670.D1','SJHGG030671.D1','SJHGG030673.D1','SJHGG030688.D1','SJHGG030697.D1','SJHGG030699.D1','SJHGG030703.D1','SJHGG030703.D2','SJHGG030716.D1','SJHGG030738.D1','SJHGG030775.D2','SJHGG030779.D1','SJHGG030796.D1','SJHGG030803.D1','SJHGG030803.D2','SJHGG030851.D1','SJHGG030859.D1','SJHGG030895.D1','SJHGG030905.D1','SJHGG030920.D1','SJHGG030932.D1','SJHGG030960.D1','SJHGG030964.D1','SJHGG031038.D1','SJHGG031040.D1','SJHGG031097.D1','SJHGG031119.D1','SJHGG031139.D1','SJHGG031140.D1','SJHGG031167.D1','SJHGG031177.D1','SJHGG031178.D1','SJHGG031178.D2','SJHGG031182.D1','SJHGG031184.D1','SJHGG031190.D1','SJHGG031195.D1','SJHGG031204.D1','SJHGG031209.D1','SJHGG031230.D1','SJHGG031234.D1','SJHGG031274.D1','SJHGG031275.D1','SJHGG031279.D1','SJHGG031282.D1','SJHGG031321.D1','SJHGG031322.D1','SJHGG031332.D1','SJHGG031380.D1','SJHGG031396.D1','SJHGG031489.D1','SJHGG031511.D1','SJLGG020.D','SJLGG022.D','SJLGG026.D','SJLGG030162.D1','SJLGG030165.D1','SJLGG030182.D1','SJLGG030202.D1','SJLGG030321.D1','SJLGG030326.D1','SJLGG030340.D1','SJLGG030341.D1','SJLGG030365.D1','SJLGG030387.D1','SJLGG030394.D1','SJLGG030395.D1','SJLGG030401.D1','SJLGG030417.D1','SJLGG030496.D1','SJLGG030575.D1','SJLGG030575.D2','SJLGG030599.D1','SJLGG030611.D1','SJLGG030611.D2','SJLGG030664.D1','SJLGG030687.D1','SJLGG030715.D1','SJLGG030728.D1','SJLGG030729.D1','SJLGG030736.D1','SJLGG030788.D1','SJLGG030797.D1','SJLGG030798.D1','SJLGG030813.D1','SJLGG030818.D1','SJLGG030866.D1','SJLGG030867.D1','SJLGG030874.D1','SJLGG030899.D1','SJLGG030938.D1','SJLGG030959.D1','SJLGG031050.D1','SJLGG031091.D1','SJLGG031096.D1','SJLGG031127.D1','SJLGG031132.D2','SJLGG031166.D1','SJLGG031174.D1','SJLGG031179.D1','SJLGG031191.D1','SJLGG031220.D1','SJLGG031223.D1','SJLGG031240.D1','SJLGG031247.D1','SJLGG031256.D1','SJLGG031283.D1','SJLGG031306.D1','SJLGG031310.D1','SJLGG031317.D1','SJLGG031324.D1','SJLGG031436.D1','SJLGG031459.D1','SJLGG031460.D1','SJLGG031479.D1','SJLGG031523.D1','SJLGG035.D','SJLGG036.D','SJLGG038.D','SJLGG039.D','SJMB002.D','SJMB009.E','SJMB028.D','SJMB030020.D1','SJMB030021.D1','SJMB030055.D1','SJMB030056.D1','SJMB030087.D1','SJMB030089.D1','SJMB030092.D1','SJMB030110.D1','SJMB030114.D1','SJMB030114.D2','SJMB030139.D1','SJMB030181.D1','SJMB030187.D1','SJMB030239.D1','SJMB030251.D1','SJMB030296.D1','SJMB030312.D1','SJMB030315.D1','SJMB030333.D1','SJMB030352.D1','SJMB030357.D1','SJMB030364.D1','SJMB030385.D1','SJMB030396.D1','SJMB030407.D1','SJMB030426.D1','SJMB030446.D1','SJMB030453.D1','SJMB030468.D1','SJMB030488.D1','SJMB030498.D1','SJMB030504.D1','SJMB030530.D1','SJMB030536.D1','SJMB030539.D1','SJMB030557.D1','SJMB030562.D1','SJMB030582.D1','SJMB030583.D1','SJMB030590.D1','SJMB030593.D1','SJMB030594.D1','SJMB030596.D1','SJMB030608.D1','SJMB030610.D1','SJMB030613.D1','SJMB030620.D1','SJMB030649.D1','SJMB030656.D1','SJMB030667.D1','SJMB030679.D1','SJMB030682.D1','SJMB030695.D1','SJMB030696.D1','SJMB030706.D1','SJMB030711.D1','SJMB030712.D1','SJMB030744.D1','SJMB030748.D1','SJMB030750.D1','SJMB030753.D1','SJMB030757.D1','SJMB030776.D1','SJMB030785.D1','SJMB030790.D1','SJMB030825.D1','SJMB030827.D1','SJMB030828.D1','SJMB030838.D1','SJMB030839.D1','SJMB030910.D1','SJMB030910.D2','SJMB030914.D1','SJMB030915.D1','SJMB030915.D2','SJMB030919.D1','SJMB030931.D1','SJMB030949.D1','SJMB030966.D1','SJMB031001.D1','SJMB031016.D1','SJMB031018.D1','SJMB031039.D1','SJMB031041.D2','SJMB031068.D1','SJMB031098.D1','SJMB031110.D1','SJMB031112.D1','SJMB031118.D1','SJMB031126.D1','SJMB031131.D1','SJMB031133.D2','SJMB031162.D1','SJMB031165.D1','SJMB031176.D1','SJMB031187.D1','SJMB031193.D1','SJMB031216.D1','SJMB031227.D1','SJMB031229.D1','SJMB031318.D1','SJMB031328.D1','SJMB031335.D1','SJMB031346.D1','SJMB031371.D1','SJMB031374.D1','SJMB031400.D1','SJMB031418.D1','SJMB031439.D1','SJMB031453.D1','SJMB031475.D1','SJMB031476.D1','SJMB031493.D1','SJMB031540.D1','SJMB067.D')
col_labels = A;
labels = col_labels;
selection = log2(selection[labels] + 1.0);
zselection = selection
colnames(zselection) = names(selection)
selection = as.matrix(zselection);
selection[is.na(selection)] = 0;
geneList = "CD276";
geneList = c(geneList, "B4GALNT1");
geneList = c(geneList, "IL13RA2");
geneList = c(geneList, "EPHA2");
geneList = c(geneList, "ERBB2");
geneList = c(geneList, "HLA-B");
geneList = c(geneList, "HLA-C");
geneList = c(geneList, "HLA-A");
geneList = c(geneList, "CD19");
dataset = selection[geneList,]
dataset = dataset[apply(dataset[,-1], 1, function(x) !all(x==0)),]
library(pheatmap)
minimum = min(dataset);
maximum = max(dataset);
annotation = read.csv(file="brain_clinical_annotation.txt",head=TRUE,sep="\t",stringsAsFactors=F,row.names = 1)
bk = c(seq(minimum,minimum/2, length=100), seq(minimum/2,maximum/2,length=100),seq(maximum/2,maximum,length=100))
hmcols<- colorRampPalette(c("white","blue","red"))(length(bk)-1)
png(file = "Brain_Clinical_TPM_annotate_geneName_reorder_AVGMAX_surface_antigen.txt_nonorm.png", width=800,height=400)
result2 = pheatmap(dataset, cluster_col = F, cluster_row = F, fontsize_row = 12, fontsize_col = 12, show_rownames = T , show_colnames = F , clustering_method = "ward", color=hmcols, annotation_col=annotation)
dev.off();
write.table(result2$tree_col$labels[result2$tree_col$order], file="Brain_Clinical_TPM_annotate_geneName_reorder_AVGMAX_surface_antigen.txt_nonorm.png._ordered_colnames.txt")
write.table(result2$tree_row$labels[result2$tree_row$order], file="Brain_Clinical_TPM_annotate_geneName_reorder_AVGMAX_surface_antigen.txt_nonorm.png._ordered_row.txt")

